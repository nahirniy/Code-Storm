{"version":3,"file":"modal-subscription-685fd011.js","sources":["../../src/img/icons/sprite.svg","../../src/js/services/helpers.js","../../src/js/services/food-api.js","../../src/js/modals/modal-subscription/modal-subscription.js"],"sourcesContent":["export default \"__VITE_ASSET__a9bd2a53__\"","import Swal from 'sweetalert2';\nimport sprite from '../../img/icons/sprite.svg';\n\n// ТУТ ПИШЕ ТІЛЬКИ МАКС\nexport function saveToLS(key, value) {\n  localStorage.setItem(key, JSON.stringify(value));\n}\n\nexport function loadFromLS(key) {\n  const data = localStorage.getItem(key);\n\n  try {\n    return JSON.parse(data);\n  } catch {\n    showError();\n    return data;\n  }\n}\n\nexport function createParams(parameters) {\n  const { keyword, category, page, limit, ...rest } = parameters;\n  const checkedSortBy = Object.keys(rest).length;\n\n  const params = new URLSearchParams({\n    page,\n    limit,\n  });\n\n  if (keyword) {\n    params.set('keyword', keyword);\n  }\n\n  if (category) {\n    params.set('category', category);\n  }\n\n  if (checkedSortBy) {\n    const [sortBy, state] = Object.entries(rest)[0];\n    params.set(sortBy, state);\n  }\n\n  return params;\n}\n\nexport function updateBasket(LOCALSTORAGE_KEY, currentProduct, basket) {\n  const index = basket.findIndex(product => product._id === currentProduct._id);\n  index !== -1 ? basket.splice(index, 1) : basket.push(currentProduct);\n\n  saveToLS(LOCALSTORAGE_KEY, basket);\n  counterProducts(basket);\n}\n\nexport function counterProducts(basket) {\n  const oldNumberProducts = document.querySelector('.number-products');\n  const newNumberProducts = basket.length;\n\n  oldNumberProducts.textContent = newNumberProducts;\n}\n\nexport function editText(someText) {\n  return someText.replaceAll('_', ' ');\n}\n\nexport function showError() {\n  Swal.fire({\n    icon: 'error',\n    title: 'Oops...',\n    text: 'Something went wrong!',\n  });\n}\n\nexport function showLoader() {\n  const loader = document.querySelector('.loader-container');\n  loader.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  const loader = document.querySelector('.loader-container');\n\n  setTimeout(() => loader.classList.add('is-hidden'), 300);\n}\n\nexport function checkedParams(oldParams, newParams) {\n  return !(JSON.stringify(oldParams) === JSON.stringify(newParams));\n}\n\nexport function updateAllIcon(buttons, id, basket) {\n  for (let i = 0; i < buttons.length; i += 1) {\n    switch (true) {\n      case buttons[i].classList.contains('main-products-btn'):\n        updateIconMain(buttons[i], id, basket);\n        break;\n      case buttons[i].classList.contains('popular-products-btn'):\n        updateIconPopular(buttons[i], id, basket);\n        break;\n      case buttons[i].classList.contains('discount-products-btn'):\n        updateDiscountIcon(buttons[i], id, basket);\n        break;\n      default:\n        break;\n    }\n  }\n}\n\nfunction updateIconMain(btn, id, products) {\n  const checkmarkIcon = `<svg class=\"svg-checkmark\" width=\"18\" height=\"18\">\n            <use class=\"href-icon\" href=\"${sprite}#icon-checkmark\"></use>\n          </svg>`;\n  const basketIcon = `<svg class=\"svg-basket\" width=\"18\" height=\"18\">\n            <use class=\"href-icon\" href=\"${sprite}#icon-basket\"></use>\n          </svg>`;\n\n  const inStorage = products.some(({ _id }) => _id === id);\n\n  btn.innerHTML = inStorage ? checkmarkIcon : basketIcon;\n}\n\nfunction updateDiscountIcon(btn, id, products) {\n  const checkmarkIcon = `<svg class=\"svg-checkmark\" width=\"18\" height=\"18\">\n            <use class=\"href-icon\" href=\"${sprite}#icon-checkmark\"></use>\n          </svg>`;\n  const basketIcon = `<svg class=\"svg-basket\" width=\"18\" height=\"18\">\n            <use class=\"href-icon\" href=\"${sprite}#icon-basket\"></use>\n          </svg>`;\n\n  const inStorage = products.some(({ _id }) => _id === id);\n\n  btn.innerHTML = inStorage ? checkmarkIcon : basketIcon;\n}\n\nfunction updateIconPopular(btn, id, products) {\n  const checkmarkIcon = `<svg class=\"light-checkmark\" width=\"12\" height=\"12\">\n            <use class=\"href-icon\" href=\"${sprite}#icon-checkmark\"></use>\n          </svg>`;\n  const basketIcon = `<svg class=\"light-basket\" width=\"12\" height=\"12\">\n            <use class=\"href-icon\" href=\"${sprite}#icon-basket\"></use>\n          </svg>`;\n\n  const inStorage = products.some(({ _id }) => _id === id);\n\n  btn.innerHTML = inStorage ? checkmarkIcon : basketIcon;\n}\n","// ТУТ ПИШЕ ТІЛЬКИ МАКС\nimport axios from 'axios';\nimport { createParams } from './helpers';\n\naxios.defaults.baseURL = 'https://food-boutique.b.goit.study/api';\n\nexport const getCategoryList = async () => {\n  const { data } = await axios.get(`/products/categories`);\n\n  return data;\n};\n\nexport const getCurrentProducts = async parameters => {\n  const params = createParams(parameters);\n\n  const { data } = await axios.get(`/products/`, { params });\n\n  return data;\n};\n\nexport const getProductById = async id => {\n  const { data } = await axios.get(`/products/${id}`);\n\n  return data;\n};\n\nexport const getPopularProducts = async limit => {\n  const { data } = await axios.get(`/products/popular?limit=${limit}`);\n\n  return data;\n};\n\nexport const getDiscountProducts = async () => {\n  const { data } = await axios.get(`/products/discount`);\n\n  return data;\n};\n\nexport const addOrder = async body => {\n  const { data } = await axios.post(`/orders`, body);\n\n  return data;\n};\n\nexport const addEmail = async body => {\n  const { data } = await axios.post(`/subscription`, body);\n\n  return data;\n};\n","import { addEmail } from '../../services/food-api';\nimport { showError } from '../../services/helpers';\n\nconst formElem = document.querySelector('.form-footer');\nconst modalSubscription = document.querySelector('.modal-subscription');\nconst modalUnsubscription = document.querySelector('.modal-unsubscription');\nconst modalBackElem = document.querySelector('.modal-backdrop-subscription');\nconst body = document.querySelector('body');\nconst overflow = document.body.style.overflow;\n\nconst closeModal = event => {\n  const target = event.target;\n  if (target === modalSubscription || target.closest('.close')) {\n    modalSubscription.classList.remove('visible-modal');\n    setTimeout(() => modalSubscription.classList.add('visually-hidden'), 500);\n    modalBackElem.classList.add('is-hidden');\n  }\n  if (target === modalUnsubscription || target.closest('.close')) {\n    modalUnsubscription.classList.remove('visible-modal');\n    setTimeout(() => modalUnsubscription.classList.add('visually-hidden'), 500);\n    modalBackElem.classList.add('is-hidden');\n  }\n\n  if (event.key === 'Escape') {\n    closeModalOption();\n  }\n\n  if (target === modalBackElem) {\n    closeModalOption();\n  }\n};\n\nconst openModalSubscription = () => {\n  modalSubscription.classList.add('visible-modal');\n  modalSubscription.classList.remove('visually-hidden');\n  modalBackElem.classList.remove('is-hidden');\n\n  document.addEventListener('keydown', closeModal);\n  body.style.overflow = 'hidden';\n};\n\nconst openModalUnsubscription = () => {\n  modalUnsubscription.classList.add('visible-modal');\n  modalUnsubscription.classList.remove('visually-hidden');\n  modalBackElem.classList.remove('is-hidden');\n\n  document.addEventListener('keydown', closeModal);\n  body.style.overflow = 'hidden';\n};\n\nconst handleSubscription = async email => {\n  const body = { email };\n\n  try {\n    const checkedEmail = await addEmail(body);\n\n    openModalSubscription();\n  } catch (err) {\n    if (err.response.data.message === 'Subscription already exists') {\n      openModalUnsubscription();\n    } else {\n      showError();\n    }\n  }\n};\n\nfunction handleSubmit(e) {\n  e.preventDefault();\n  const emailInput = document.querySelector('.input-label');\n  const email = emailInput.value.trim();\n  handleSubscription(email);\n}\n\nfunction closeModalOption() {\n  modalSubscription.classList.remove('visible-modal');\n  setTimeout(() => modalSubscription.classList.add('visually-hidden'), 500);\n  modalBackElem.classList.add('is-hidden');\n\n  modalUnsubscription.classList.remove('visible-modal');\n  setTimeout(() => modalUnsubscription.classList.add('visually-hidden'), 500);\n  modalBackElem.classList.add('is-hidden');\n\n  document.removeEventListener('keydown', closeModal);\n  body.style.overflow = overflow;\n}\n\nformElem.addEventListener('submit', handleSubmit);\nmodalBackElem.addEventListener('click', closeModal);\n"],"names":["sprite","saveToLS","key","value","loadFromLS","data","showError","createParams","parameters","keyword","category","page","limit","rest","checkedSortBy","params","sortBy","state","updateBasket","LOCALSTORAGE_KEY","currentProduct","basket","index","product","counterProducts","oldNumberProducts","newNumberProducts","editText","someText","Swal","showLoader","hideLoader","loader","checkedParams","oldParams","newParams","updateAllIcon","buttons","id","i","updateIconMain","updateIconPopular","updateDiscountIcon","btn","products","checkmarkIcon","basketIcon","inStorage","_id","axios","getCategoryList","getCurrentProducts","getProductById","getPopularProducts","getDiscountProducts","addOrder","body","addEmail","formElem","modalSubscription","modalUnsubscription","modalBackElem","overflow","closeModal","event","target","closeModalOption","openModalSubscription","openModalUnsubscription","handleSubscription","email","checkedEmail","err","handleSubmit"],"mappings":"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"}