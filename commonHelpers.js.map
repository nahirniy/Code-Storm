{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart-content/product-list/pr-list-markap.js","../src/js/cart-content/product-list/pr-list-localStorage.js","../src/js/cart-content/product-list/product-list.js","../src/js/modals/modal-order/modal-order.js","../src/js/cart-content/order-products/order-products.js"],"sourcesContent":["import sprite from '../../../img/icons/sprite.svg';\n// функция разметки корзины с товаром\nexport const funCartCreateMarkup = function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        name,\n        category,\n        size,\n        price,\n        img,\n        _id,\n      }) => `<li class=\"cart-item\" data-id=\"${_id}\">\n      <div class=\"cart-item-wrap\">\n        <div class=\"cart-img-container\">\n          <img class=\"cart-img\" src=\"${img}\" alt=\"${name}\" />\n        </div>\n        <div class=\"cart-img-text\">\n        <div class=\"cart-item-title-wrap\"><h3 class=\"cart-item-title\">${name}</h3>\n        <button name=\"button\" type=\"button\" class=\"cart-btn-close\">\n        <svg class=\"cart-icon-close\">\n          <use href=\"${sprite}#icon-close\"></use>\n        </svg>\n      </button>\n        </div>\n          \n          <div class=\"cart-info-container\">\n            <p class=\"cart-info\">\n              Category:\n              <span>${category.replaceAll('_', ' ')}</span>\n            </p>\n            <p class=\"cart-info cart-info-overflow\">\n              Size:\n              <span>${size}</span>\n            </p>\n          </div>\n          <h3 class=\"cart-info-price\">$${price}</h3>\n        </div> \n      </div>\n     \n    </li>`\n    )\n    .join('');\n};\n","// удаление всех элементов из локалстораж при клике на del all\nexport const funLoadLellAllLS = function LoadLellAllLS(key) {\n  localStorage.removeItem(key);\n};\n","import { funCartCreateMarkup } from './pr-list-markap';\nimport { funLoadLellAllLS } from './pr-list-localStorage';\nimport { loadFromLS } from '../../services/helpers';\n\nconst refs = {\n  cartContent: document.querySelector('.cart-content-wrap'),\n  cartTitle: document.querySelector('.cart-title'),\n  cartTitleContainer: document.querySelector('.cart-title-container'),\n  cartItemContainer: document.querySelector('.cart-item-container'),\n  cartBtnDelAll: document.querySelector('.cart-btn-del-all'),\n  cartEmptyContent: document.querySelector('.cart-yellow-container'),\n  cartProductsSum: document.querySelector('.order-products-sum'),\n  cartBtnDellContainer: document.querySelector('.cart-btn-wrap'),\n  cartOrderProducts: document.querySelector('.order-products'),\n};\n\nrefs.cartItemContainer.addEventListener('click', onCartItem);\nrefs.cartBtnDelAll.addEventListener('click', onCartDellAll);\n\nconst LOCALSTORAGE_KEY = 'basket';\nconst cartResults = loadFromLS(LOCALSTORAGE_KEY) ?? [];\nlet arrayLength = cartResults.length;\nlet newTotal = cartTotal(cartResults);\n\ncartProductList();\n\n// колбек кнопки удалить все\nfunction onCartDellAll() {\n  refs.cartItemContainer.innerHTML = '';\n\n  funLoadLellAllLS(LOCALSTORAGE_KEY);\n  arrayLength = 0;\n  cartTitleAdd(arrayLength);\n  refs.cartEmptyContent.classList.remove('visually-hidden');\n  refs.cartBtnDellContainer.classList.add('visually-hidden');\n  refs.cartOrderProducts.classList.add('visually-hidden');\n}\n\n// колбек удаления поштучно\nfunction onCartItem(evt) {\n  const evtBtn = evt.target.closest('.cart-btn-close');\n  if (!evtBtn.nodeName) {\n    return;\n  }\n\n  const cartItemDell = evt.target.closest('.cart-item');\n  const cartIdDell = cartItemDell.dataset.id;\n\n  // удаление элемента из локалстораж и разметки\n  const indexToRemove = cartResults.findIndex(obj => obj._id === cartIdDell);\n\n  cartResults.splice(indexToRemove, 1);\n  localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(cartResults));\n  cartItemDell.remove();\n\n  //============\n  arrayLength -= 1;\n  if (arrayLength < 4) {\n    refs.cartItemContainer.classList.remove('cart-scrol');\n  }\n  cartTitleAdd(arrayLength);\n\n  // берем новый масив из локал сторож и  пересситываем тотал\n  newTotal = cartTotal(cartResults);\n\n  // если в корзине пусто - выводим пустую корзину\n  const recountItem = evt.currentTarget.childNodes.length;\n  if (recountItem === 0) {\n    refs.cartEmptyContent.classList.remove('visually-hidden');\n    refs.cartBtnDellContainer.classList.add('visually-hidden');\n    refs.cartOrderProducts.classList.add('visually-hidden');\n    return;\n  }\n\n  refs.cartProductsSum.innerHTML = `$${String(newTotal.toFixed(2))}`;\n  refs.cartEmptyContent.classList.add('visually-hidden');\n  refs.cartContent.classList.remove('visually-hidden');\n}\n\n// добавление заголовка\nfunction cartTitleAdd(leng) {\n  refs.cartTitle.textContent = `cart (${leng})`;\n}\n\n// главная функция-создание контента корзины\nfunction cartProductList() {\n  cartTitleAdd(arrayLength);\n\n  if (!arrayLength) {\n    refs.cartEmptyContent.classList.remove('visually-hidden');\n    refs.cartContent.classList.add('visually-hidden');\n    return;\n  }\n\n  refs.cartEmptyContent.classList.add('visually-hidden');\n  refs.cartContent.classList.remove('visually-hidden');\n\n  refs.cartItemContainer.innerHTML = funCartCreateMarkup(cartResults);\n  refs.cartProductsSum.innerHTML = `$${String(newTotal.toFixed(2))}`;\n}\n\n// функция для подсчета тотал\nfunction cartTotal(results) {\n  const totalPrice = results.reduce((total, result) => {\n    return total + result.price;\n  }, 0);\n  return totalPrice;\n}\n","import { saveToLS } from '../../services/helpers';\n\nexport function modalOrder() {\n  const modalBackdropOrder = document.querySelector('.modal-backdrop-order');\n  const modalOrder = document.querySelector('.modal-order');\n\n  modalBackdropOrder.classList.remove('is-hidden');\n  modalOrder.classList.add('visible-modal');\n}\nconst modalOrderClose = document.querySelector('.modal-order-close');\nmodalOrderClose.addEventListener('click', event => {\n  const modalBackdropOrder = document.querySelector('.modal-backdrop-order');\n  const modalOrder = document.querySelector('.modal-order');\n  modalBackdropOrder.classList.add('is-hidden');\n  modalOrder.classList.remove('visible-modal');\n\n  const LOCALSTORAGE_KEY = 'basket';\n  saveToLS(LOCALSTORAGE_KEY, []);\n  document.querySelector('.order-products-sum').textContent = '$0.00';\n});\n","import { modalOrder } from '../../modals/modal-order/modal-order';\nimport { addOrder } from '../../services/food-api';\nimport {\n  counterProducts,\n  loadFromLS,\n  saveToLS,\n  showError,\n} from '../../services/helpers';\n\nconst LOCALSTORAGE_KEY = 'basket';\nconst basket = loadFromLS(LOCALSTORAGE_KEY) ?? [];\n\nconst orderForm = document.querySelector('.order-products-form');\nconst emptyContent = document.querySelector('.cart-yellow-container');\nconst cartContent = document.querySelector('.cart-content-wrap');\n\norderForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  const emailInput = event.target.querySelector('#email');\n  const email = emailInput.value;\n\n  const orderProducts = basket.map(product => {\n    return {\n      productId: product._id,\n      amount: 1,\n    };\n  });\n\n  try {\n    const order = await addOrder({\n      email: email,\n      products: orderProducts,\n    });\n\n    saveToLS(LOCALSTORAGE_KEY, []);\n    counterProducts([]);\n    modalOrder();\n\n    cartContent.classList.add('visually-hidden');\n    emptyContent.classList.remove('visually-hidden');\n  } catch (err) {\n    showError();\n    console.log(err);\n  } finally {\n    orderForm.reset();\n  }\n});\n\ncounterProducts(basket);\n"],"names":["funCartCreateMarkup","arr","name","category","size","price","img","_id","sprite","funLoadLellAllLS","key","refs","onCartItem","onCartDellAll","LOCALSTORAGE_KEY","cartResults","loadFromLS","arrayLength","newTotal","cartTotal","cartProductList","cartTitleAdd","evt","cartItemDell","cartIdDell","indexToRemove","obj","leng","results","total","result","modalOrder","modalBackdropOrder","modalOrderClose","event","saveToLS","basket","orderForm","emptyContent","cartContent","email","orderProducts","product","order","addOrder","counterProducts","err","showError"],"mappings":"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"}